# Metrics

Document describes metrics related with libvirt-provider or libvirt daemon.

**Last update:** 2024-12-04T13:53:18+01:00

## libvirt-provider metrics

It contains list of metrics exposed by libvirt-provider.

| Metric                                        |                  Type                  | Custom | Description                                                                                                                                                                                                                          |
| --------------------------------------------- | :------------------------------------: | :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| go_gc_duration_seconds                        |                summary                 |        | A summary of the pause duration of garbage collection cycles.                                                                                                                                                                        |
| go_goroutines                                 |                 gauge                  |        | Number of goroutines that currently exist.                                                                                                                                                                                           |
| go_info                                       |                 gauge                  |        | Information about the Go environment.                                                                                                                                                                                                |
| go_memstats_alloc_bytes                       |                 gauge                  |        | Number of bytes allocated and still in use.                                                                                                                                                                                          |
| go_memstats_alloc_bytes_total                 |                counter                 |        | Total number of bytes allocated, even if freed.                                                                                                                                                                                      |
| go_memstats_buck_hash_sys_bytes               |                 gauge                  |        | Number of bytes used by the profiling bucket hash table.                                                                                                                                                                             |
| go_memstats_frees_total                       |                counter                 |        | Total number of frees.                                                                                                                                                                                                               |
| go_memstats_gc_sys_bytes                      |                 gauge                  |        | Number of bytes used for garbage collection system metadata.                                                                                                                                                                         |
| go_memstats_heap_alloc_bytes                  |                 gauge                  |        | Number of heap bytes allocated and still in use.                                                                                                                                                                                     |
| go_memstats_heap_idle_bytes                   |                 gauge                  |        | Number of heap bytes waiting to be used.                                                                                                                                                                                             |
| go_memstats_heap_inuse_bytes                  |                 gauge                  |        | Number of heap bytes that are in use.                                                                                                                                                                                                |
| go_memstats_heap_objects                      |                 gauge                  |        | Number of allocated objects.                                                                                                                                                                                                         |
| go_memstats_heap_released_bytes               |                 gauge                  |        | Number of heap bytes released to OS.                                                                                                                                                                                                 |
| go_memstats_heap_sys_bytes                    |                 gauge                  |        | Number of heap bytes obtained from system.                                                                                                                                                                                           |
| go_memstats_last_gc_time_seconds              |                 gauge                  |        | Number of seconds since 1970 of last garbage collection.                                                                                                                                                                             |
| go_memstats_lookups_total                     |                counter                 |        | Total number of pointer lookups.                                                                                                                                                                                                     |
| go_memstats_mallocs_total                     |                counter                 |        | Total number of mallocs.                                                                                                                                                                                                             |
| go_memstats_mcache_inuse_bytes                |                 gauge                  |        | Number of bytes in use by mcache structures.                                                                                                                                                                                         |
| go_memstats_mcache_sys_bytes                  |                 gauge                  |        | Number of bytes used for mcache structures obtained from system.                                                                                                                                                                     |
| go_memstats_mspan_inuse_bytes                 |                 gauge                  |        | Number of bytes in use by mspan structures.                                                                                                                                                                                          |
| go_memstats_mspan_sys_bytes                   |                 gauge                  |        | Number of bytes used for mspan structures obtained from system.                                                                                                                                                                      |
| go_memstats_next_gc_bytes                     |                 gauge                  |        | Number of heap bytes when next garbage collection will take place.                                                                                                                                                                   |
| go_memstats_other_sys_bytes                   |                 gauge                  |        | Number of bytes used for other system allocations.                                                                                                                                                                                   |
| go_memstats_stack_inuse_bytes                 |                 gauge                  |        | Number of bytes in use by the stack allocator.                                                                                                                                                                                       |
| go_memstats_stack_sys_bytes                   |                 gauge                  |        | Number of bytes obtained from system for stack allocator.                                                                                                                                                                            |
| go_memstats_sys_bytes                         |                 gauge                  |        | Number of bytes obtained from system.                                                                                                                                                                                                |
| go_threads                                    |                 gauge                  |        | Number of OS threads created.                                                                                                                                                                                                        |
| process_cpu_seconds_total                     |                counter                 |        | Total user and system CPU time spent in seconds.                                                                                                                                                                                     |
| process_max_fds                               |                 gauge                  |        | Maximum number of open file descriptors.                                                                                                                                                                                             |
| process_open_fds                              |                 gauge                  |        | Number of open file descriptors.                                                                                                                                                                                                     |
| process_resident_memory_bytes                 |                 gauge                  |        | Resident memory size in bytes.                                                                                                                                                                                                       |
| process_start_time_seconds                    |                 gauge                  |        | Start time of the process since unix epoch in seconds.                                                                                                                                                                               |
| process_virtual_memory_bytes                  |                 gauge                  |        | Virtual memory size in bytes.                                                                                                                                                                                                        |
| process_virtual_memory_max_bytes              |                 gauge                  |        | Maximum amount of virtual memory available in bytes.                                                                                                                                                                                 |
| promhttp_metric_handler_requests_in_flight    |                 gauge                  |        | Current number of scrapes being served.                                                                                                                                                                                              |
| promhttp_metric_handler_requests_total        |                counter                 |        | Total number of scrapes by HTTP status code.                                                                                                                                                                                         |
| controller_runtime_reconcile_errors_total     |                counter                 |   ✅    | Total number of reconciliation errors per controller                                                                                                                                                                                 |
| controller_runtime_reconcile_duration_seconds |                summary                 |   ✅    | Length of time per reconciliation per controller                                                                                                                                                                                     |
| controller_runtime_max_concurrent_reconciles  |                 gauge                  |   ✅    | Maximum number of concurrent reconciles per controller                                                                                                                                                                               |
| controller_runtime_active_workers             |                 gauge                  |   ✅    | Number of currently used workers per controller                                                                                                                                                                                      |
| workqueue_depth                               |                 gauge                  |   ✅    | Current depth of workqueue                                                                                                                                                                                                           |
| workqueue_adds_total                          |                counter                 |   ✅    | Total number of adds handled by workqueue                                                                                                                                                                                            |
| workqueue_queue_duration_seconds              | histogram (exponential: 10e-9, 10, 12) |   ✅    | How long in seconds an item stays in workqueue before being requested                                                                                                                                                                |
| workqueue_work_duration_seconds               | histogram (exponential: 10e-9, 10, 12) |   ✅    | How long in seconds processing an item from workqueue takes.                                                                                                                                                                         |
| workqueue_unfinished_work_seconds             |                 gauge                  |   ✅    | How many seconds of work has been done that is in progress and hasn't been observed by work_duration. Large values indicate stuck threads. One can deduce the number of stuck threads by observing the rate at which this increases. |
| workqueue_longest_running_processor_seconds   |                 gauge                  |   ✅    | How many seconds has the longest running processor for workqueue been running.                                                                                                                                                       |
| workqueue_retries_total                       |                counter                 |   ✅    | Total number of retries handled by workqueue                                                                                                                                                                                         |
| operation_duration_seconds                    |                summary                 |   ✅    | Length of time per operation                                                                                                                                                                                                         |
| operation_errors_total                        |                counter                 |   ✅    | Total number of errors which affect main logic of operation                                                                                                                                                                          |
| grpc_server_handled_total                     |                counter                 |        | Total number of RPCs completed on the server, regardless of success or failure.                                                                                                                                                      |
| grpc_server_handling_seconds                  |     histogram (0.01, 0.1, 0.5, 1)      |        | Histogram of response latency (seconds) of gRPC that had been application-level handled by the server.                                                                                                                               |
| grpc_server_msg_received_total                |                counter                 |        | Total number of RPC stream messages received on the server.                                                                                                                                                                          |
| grpc_server_msg_sent_total                    |                counter                 |        | Total number of gRPC stream messages sent by the server.                                                                                                                                                                             |
| grpc_server_started_total                     |                counter                 |        | Total number of RPCs started on the server.                                                                                                                                                                                          |

## Useful links

- [Prometheus metrics types](https://prometheus.io/docs/concepts/metric_types/)
- [Prometheus metrics in Golang](https://povilasv.me/prometheus-go-metrics/)
